<!DOCTYPE html> <html> <head><meta name="generator" content="Hexo 3.9.0"> <script>var _hmt=_hmt||[]</script> <script async src="//hm.baidu.com/hm.js?3d88a42f36d311b6e2c830ea185ed398"></script> <script>!function(){var t=document.createElement("script");t.setAttribute("async",!0);var e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}()</script> <meta charset="utf-8"> <link rel="canonical" href="https://coolcode.org"> <title>几个有用的 PowerShell 脚本</title> <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"> <meta name="theme-color" content="#3F51B5"> <meta name="keywords" content="powershell"> <meta name="description" content="前一篇文章介绍了如何美化 PowerShell，今天来写几个比较实用的 PowerShell 脚本。"> <meta name="keywords" content="powershell"> <meta property="og:type" content="article"> <meta property="og:title" content="几个有用的 PowerShell 脚本"> <meta property="og:url" content="https://coolcode.org/2018/03/19/some-useful-scripts-of-powershell/index.html"> <meta property="og:site_name" content="CoolCode"> <meta property="og:description" content="前一篇文章介绍了如何美化 PowerShell，今天来写几个比较实用的 PowerShell 脚本。"> <meta property="og:locale" content="zh-CN"> <meta property="og:updated_time" content="2020-01-01T06:28:00.000Z"> <meta name="twitter:card" content="summary"> <meta name="twitter:title" content="几个有用的 PowerShell 脚本"> <meta name="twitter:description" content="前一篇文章介绍了如何美化 PowerShell，今天来写几个比较实用的 PowerShell 脚本。"> <link rel="alternate" type="application/atom+xml" title="CoolCode" href="../../../../atom.xml"> <link rel="shortcut icon" href="../../../../favicon.ico"> <link rel="stylesheet" href="../../../../css/style.css?v=1.7.2"> <script src="../../../../js/echarts.common.min.js?v=1.7.2"></script> <script>window.lazyScripts=[]</script> <link rel="manifest" href="/manifest.json"> <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/img/apple-touch-icon-precomposed-144x144.png"> <link rel="apple-touch-icon-precomposed" sizes="120x120" href="/img/apple-touch-icon-precomposed-120x120.png"> <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/img/apple-touch-icon-precomposed-72x72.png"> <link rel="apple-touch-icon-precomposed" href="/img/apple-touch-icon-precomposed-57x57.png"> </head> <body> <div id="loading" class="active"></div> <aside id="menu"> <div class="inner flex-row-vertical"> <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off"> <i class="icon icon-lg icon-close"></i> </a> <div class="brand-wrap" style="background-image:url(../../../../img/brand.jpg)"> <div class="brand"> <a href="../../../../index.html" class="avatar waves-effect waves-circle waves-light"> <img src="../../../../img/avatar.jpg"> </a> <hgroup class="introduce"> <h5 class="nickname">小马哥</h5> <a href="mailto:andot@qq.com" title="andot@qq.com" class="mail">andot@qq.com</a> </hgroup> <ul class="menu-link"> <li> <a href="https://github.com/andot" target="_blank"> <i class="icon icon-lg icon-github"></i> </a> </li> <li> <a href="https://sighttp.qq.com/authd?IDKEY=0f7b6690eff38f1a1bc274af3639750f34b370fb0f86105f" target="_blank"> <i class="icon icon-lg icon-qq"></i> </a> </li> </ul> </div> </div> <div class="scroll-wrap flex-col"> <ul class="nav"> <li class="waves-block waves-effect"> <a href="../../../../index.html"> <i class="icon icon-lg icon-home"></i> 主页 </a> </li> <li class="waves-block waves-effect"> <a href="../../../../archives"> <i class="icon icon-lg icon-archives"></i> 归档 </a> </li> <li class="waves-block waves-effect"> <a href="../../../../tags"> <i class="icon icon-lg icon-tags"></i> 标签 </a> </li> <li class="waves-block waves-effect"> <a href="../../../../categories"> <i class="icon icon-lg icon-th-list"></i> 分类 </a> </li> <li class="waves-block waves-effect"> <a href="../../../../about"> <i class="icon icon-lg icon-id-card"></i> 关于 </a> </li> </ul> </div> </div> </aside> <main id="main"> <header class="top-header" id="header"> <div class="flex-row"> <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle"> <i class="icon icon-lg icon-navicon"></i> </a> <div class="flex-col header-title ellipsis">几个有用的 PowerShell 脚本</div> <div class="search-wrap" id="search-wrap"> <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back"> <i class="icon icon-lg icon-chevron-left"></i> </a> <input type="text" id="key" class="search-input" autocomplete="off" placeholder="输入感兴趣的关键字"> <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search"> <i class="icon icon-lg icon-search"></i> </a> </div> <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare"> <i class="icon icon-lg icon-share-alt"></i> </a> </div> </header> <header class="content-header post-header"> <div class="container fade-scale"> <h1 class="title">几个有用的 PowerShell 脚本</h1> <h5 class="subtitle"> <time datetime="2018-03-19T02:04:00.000Z" itemprop="datePublished" class="page-time"> 2018年03月19日 </time> <ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="../../../../categories/编程/">编程</a><ul class="article-category-list-child"><li class="article-category-list-item"><a class="article-category-list-link" href="../../../../categories/编程/PowerShell/">PowerShell</a></li></ul></li></ul> </h5> </div> </header> <div class="container body-wrap"> <aside class="post-widget"> <nav class="post-toc-wrap post-toc-shrink" id="post-toc"> <h4>目录</h4> <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#更新-PowerShell-的-NuGet"><span class="post-toc-number">1.</span> <span class="post-toc-text">更新 PowerShell 的 NuGet</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#通过-cd…-进入上上级目录"><span class="post-toc-number">2.</span> <span class="post-toc-text">通过 cd… 进入上上级目录</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#还原-Linux-风格的-ls，ll，la-命令"><span class="post-toc-number">3.</span> <span class="post-toc-text">还原 Linux 风格的 ls，ll，la 命令</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#用-which-来查找命令的默认路径"><span class="post-toc-number">4.</span> <span class="post-toc-text">用 which 来查找命令的默认路径</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#用-killall-杀死指定名字的所有进程"><span class="post-toc-number">5.</span> <span class="post-toc-text">用 killall 杀死指定名字的所有进程</span></a></li></ol> </nav> </aside> <article id="post-some-useful-scripts-of-powershell" class="post-article article-type-post fade" itemprop="blogPost"> <div class="post-card"> <h1 class="post-card-title">几个有用的 PowerShell 脚本</h1> <div class="post-meta"> <time class="post-time" title="2018年03月19日 10:04:00" datetime="2018-03-19T02:04:00.000Z" itemprop="datePublished">2018年03月19日</time> <ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="../../../../categories/编程/">编程</a><ul class="article-category-list-child"><li class="article-category-list-item"><a class="article-category-list-link" href="../../../../categories/编程/PowerShell/">PowerShell</a></li></ul></li></ul> <span id="busuanzi_container_page_pv" title="文章总阅读量" style="display:none"> <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span> </span> </div> <div class="post-content" id="post-content" itemprop="postContent"> <p>前一篇文章介绍了如何美化 PowerShell，今天来写几个比较实用的 PowerShell 脚本。</p> <a id="more"></a> <h1 id="更新-PowerShell-的-NuGet"><a href="#更新-PowerShell-的-NuGet" class="headerlink" title="更新 PowerShell 的 NuGet"></a>更新 PowerShell 的 NuGet</h1><p>默认 PowerShell 自带的 NuGet 还是 2.8 版本，使用这个版本无法正常发布 PowerShell 模块，所以需要将 NuGet 更新到最新版本。</p> <figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Invoke-WebRequest</span> <span class="literal">-Uri</span> https://dist.nuget.org/win<span class="literal">-x86</span><span class="literal">-commandline</span>/latest/nuget.exe <span class="literal">-OutFile</span> <span class="string">"<span class="variable">$env:LOCALAPPDATA</span>\Microsoft\Windows\PowerShell\PowerShellGet\NuGet.exe"</span></span><br></pre></td></tr></table></figure> <p>运行一次就行了。</p> <h1 id="通过-cd…-进入上上级目录"><a href="#通过-cd…-进入上上级目录" class="headerlink" title="通过 cd… 进入上上级目录"></a>通过 cd… 进入上上级目录</h1><p>在命令行里我们最常用的命令应该就是 <code>cd</code> 了，因为每次切换目录都要用到。不过如果进入了比较深的目录，想要向上退几层的话，对于我这种懒人来说，要输入 <code>cd ..\..</code> 这样的命令感觉太麻烦了。要是能支持 <code>cd...</code> 或者 <code>cd ...</code> 这样的写法就简单多了。</p> <p>要实现 <code>cd...</code> 这样的写法很简单，只需要编写下面这样的脚本就可以了：</p> <figure class="highlight powershell"><figcaption><span>cd...</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">cd</span>...</span> &#123; <span class="built_in">Set-Location</span> ..\.. &#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">cd</span>....</span> &#123; <span class="built_in">Set-Location</span> ..\..\.. &#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">cd</span>.....</span> &#123; <span class="built_in">Set-Location</span> ..\..\..\.. &#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">cd</span>......</span> &#123; <span class="built_in">Set-Location</span> ..\..\..\..\.. &#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">cd</span>.......</span> &#123; <span class="built_in">Set-Location</span> ..\..\..\..\..\.. &#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">cd</span>........</span> &#123; <span class="built_in">Set-Location</span> ..\..\..\..\..\..\.. &#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">cd</span>.........</span> &#123; <span class="built_in">Set-Location</span> ..\..\..\..\..\..\..\.. &#125;</span><br></pre></td></tr></table></figure> <p>如果你愿意的话，可以定义更长的函数。</p> <p>如果希望 <code>cd</code> 和 <code>...</code> 之间有空格也好用的话，那就稍微复杂一些了，不过也是可以实现的：</p> <figure class="highlight powershell"><figcaption><span>增强型 cd</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Set-CurrentWorkingDirectory</span></span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">param</span></span><br><span class="line">    (</span><br><span class="line">        <span class="variable">$Path</span>,</span><br><span class="line">        <span class="variable">$LiteralPath</span>,</span><br><span class="line">        <span class="variable">$PassThru</span>,</span><br><span class="line">        <span class="variable">$StackName</span>,</span><br><span class="line">        <span class="variable">$UseTransaction</span></span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$Path</span> <span class="operator">-and</span> (<span class="variable">$Path</span>.Contains(<span class="string">'...'</span>)))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$a</span> = [<span class="type">System.Text.RegularExpressions.Regex</span>]::Split(<span class="variable">$Path</span>, <span class="string">"(\.&#123;3,&#125;)"</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> <span class="operator">-lt</span> <span class="variable">$a</span>.Length; <span class="variable">$i</span>++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$e</span> = <span class="variable">$a</span>[<span class="variable">$i</span>];</span><br><span class="line">            <span class="variable">$l</span> = <span class="variable">$e</span>.Length;</span><br><span class="line">            <span class="keyword">if</span> ((<span class="variable">$l</span> <span class="operator">-gt</span> <span class="number">2</span>) <span class="operator">-and</span> (<span class="variable">$e</span> <span class="operator">-eq</span> <span class="string">""</span>.PadRight(<span class="variable">$l</span>, <span class="string">'.'</span>)))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="variable">$a</span>[<span class="variable">$i</span>] = <span class="string">".."</span> + [<span class="type">System.String</span>]::Concat([<span class="type">System.Linq.Enumerable</span>]::Repeat(<span class="string">"\.."</span>, <span class="variable">$l</span> - <span class="number">2</span>))</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$PSBoundParameters</span>[<span class="string">'Path'</span>] = [<span class="type">System.String</span>]::Concat(<span class="variable">$a</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Set-Location</span> @PSBoundParameters</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Set-Alias</span> cd <span class="built_in">Set-CurrentWorkingDirectory</span> <span class="literal">-Option</span> <span class="string">"AllScope"</span></span><br></pre></td></tr></table></figure> <p>上面这段代码定义了一个 <code>Set-CurrentWorkingDirectory</code> 函数，它做的事情很简单，就是把路径中的 <code>...</code> 都替换成 <code>..\..</code> 的形式，然后再传给 Set-Location。</p> <p>其中 <code>...</code> 可以是任意长度，比如 <code>....</code> 或 <code>............................</code> 都可以，只要你真的需要这么长的路径。</p> <p>路径中间的 <code>...</code> 也可以被替换，例如：<code>D:\Git\CoolCode\themes\indigo\source\....\source</code>，会被替换为<code>D:\Git\CoolCode\themes\indigo\source\..\..\..\source</code>。</p> <p>好了，现在把上面两段代码加入到：</p> <blockquote> <p>C:\Users\andot\Documents\WindowsPowerShell\Microsoft.PowerShell_profile.ps1<br>C:\Users\andot\Documents\WindowsPowerShell\Microsoft.VSCode_profile.ps1</p> </blockquote> <p>中，然后再启动 PowerShell 就可以使用这个增强版的 <code>cd</code> 命令了。</p> <p>注意，我这里没有替换 <code>chdir</code> 这个别名。因为 PowerShell 是跨平台的，在 Linux 上是可以建立 <code>...</code> 这样名字的目录的，所以，如果真的是要进入这样的目录，而不是上退两层目录的话，至少还可以使用 <code>chdir</code> 这个别名。Windows 上就无所谓了，因为 Windows 上无法创建这样的目录，也无法正常进入已存在的这样的目录。</p> <h1 id="还原-Linux-风格的-ls，ll，la-命令"><a href="#还原-Linux-风格的-ls，ll，la-命令" class="headerlink" title="还原 Linux 风格的 ls，ll，la 命令"></a>还原 Linux 风格的 ls，ll，la 命令</h1><p><code>ls</code> 命令在 Linux 上的行为默认只是把文件名列出来，而 PowerShell 上的 <code>ls</code> 是以列表的形式列出文件详情列表。如果只想看文件名，还要用 <code>ls | Format-Wide -AutoSize</code> 这样的方式，感觉甚是麻烦。另外，在 Linux 上一般也会自定义 <code>ll</code>、<code>la</code> 这样的别名，比如 <code>ll</code> 会以列表形式显示文件详情，<code>la</code> 会列出包含隐藏文件在内的所有文件。下面的代码就是用来还原这种 Linux 风格操作的，另外，我还在其中加了一个 <code>lla</code> 别名，什么功能看名字应该就能猜出来吧。</p> <figure class="highlight powershell"><figcaption><span>还原 Linux 风格的 ls，ll，la 命令</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Get-ChildItem-Wide</span></span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">param</span></span><br><span class="line">    (</span><br><span class="line">        <span class="variable">$Path</span>,</span><br><span class="line">        <span class="variable">$LiteralPath</span>,</span><br><span class="line">        <span class="variable">$Filter</span>,</span><br><span class="line">        <span class="variable">$Include</span>,</span><br><span class="line">        <span class="variable">$Exclude</span>,</span><br><span class="line">        <span class="variable">$Recurse</span>,</span><br><span class="line">        <span class="variable">$Force</span>,</span><br><span class="line">        <span class="variable">$Name</span>,</span><br><span class="line">        <span class="variable">$UseTransaction</span>,</span><br><span class="line">        <span class="variable">$Attributes</span>,</span><br><span class="line">        <span class="variable">$Depth</span>,</span><br><span class="line">        <span class="variable">$Directory</span>,</span><br><span class="line">        <span class="variable">$File</span>,</span><br><span class="line">        <span class="variable">$Hidden</span>,</span><br><span class="line">        <span class="variable">$ReadOnly</span>,</span><br><span class="line">        <span class="variable">$System</span></span><br><span class="line">    )</span><br><span class="line">    <span class="built_in">Get-ChildItem</span> @PSBoundParameters | <span class="built_in">Format-Wide</span> <span class="literal">-AutoSize</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Get-ChildItem-All</span></span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">param</span></span><br><span class="line">    (</span><br><span class="line">        <span class="variable">$Path</span>,</span><br><span class="line">        <span class="variable">$LiteralPath</span>,</span><br><span class="line">        <span class="variable">$Filter</span>,</span><br><span class="line">        <span class="variable">$Include</span>,</span><br><span class="line">        <span class="variable">$Exclude</span>,</span><br><span class="line">        <span class="variable">$Recurse</span>,</span><br><span class="line">        <span class="variable">$Force</span>,</span><br><span class="line">        <span class="variable">$Name</span>,</span><br><span class="line">        <span class="variable">$UseTransaction</span>,</span><br><span class="line">        <span class="variable">$Attributes</span>,</span><br><span class="line">        <span class="variable">$Depth</span>,</span><br><span class="line">        <span class="variable">$Directory</span>,</span><br><span class="line">        <span class="variable">$File</span>,</span><br><span class="line">        <span class="variable">$Hidden</span>,</span><br><span class="line">        <span class="variable">$ReadOnly</span>,</span><br><span class="line">        <span class="variable">$System</span></span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$Attributes</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$PSBoundParameters</span>.Remove(<span class="string">'Attributes'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">Get-ChildItem</span> <span class="literal">-Attributes</span> ReadOnly, <span class="keyword">Hidden</span>, System, Normal, Archive, Directory, Encrypted, NotContentIndexed, Offline, ReparsePoint, SparseFile, Temporary @PSBoundParameters</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Get-ChildItem-All-Wide</span></span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">param</span></span><br><span class="line">    (</span><br><span class="line">        <span class="variable">$Path</span>,</span><br><span class="line">        <span class="variable">$LiteralPath</span>,</span><br><span class="line">        <span class="variable">$Filter</span>,</span><br><span class="line">        <span class="variable">$Include</span>,</span><br><span class="line">        <span class="variable">$Exclude</span>,</span><br><span class="line">        <span class="variable">$Recurse</span>,</span><br><span class="line">        <span class="variable">$Force</span>,</span><br><span class="line">        <span class="variable">$Name</span>,</span><br><span class="line">        <span class="variable">$UseTransaction</span>,</span><br><span class="line">        <span class="variable">$Attributes</span>,</span><br><span class="line">        <span class="variable">$Depth</span>,</span><br><span class="line">        <span class="variable">$Directory</span>,</span><br><span class="line">        <span class="variable">$File</span>,</span><br><span class="line">        <span class="variable">$Hidden</span>,</span><br><span class="line">        <span class="variable">$ReadOnly</span>,</span><br><span class="line">        <span class="variable">$System</span></span><br><span class="line">    )</span><br><span class="line">    <span class="built_in">Get-ChildItem</span><span class="literal">-All</span> @PSBoundParameters | <span class="built_in">Format-Wide</span> <span class="literal">-AutoSize</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Set-Alias</span> ls <span class="built_in">Get-ChildItem</span><span class="literal">-Wide</span> <span class="literal">-Option</span> <span class="string">"AllScope"</span></span><br><span class="line"><span class="built_in">Set-Alias</span> ll <span class="built_in">Get-ChildItem</span></span><br><span class="line"><span class="built_in">Set-Alias</span> lla <span class="built_in">Get-ChildItem</span><span class="literal">-All</span></span><br><span class="line"><span class="built_in">Set-Alias</span> la <span class="built_in">Get-ChildItem</span><span class="literal">-All</span><span class="literal">-Wide</span></span><br></pre></td></tr></table></figure> <h1 id="用-which-来查找命令的默认路径"><a href="#用-which-来查找命令的默认路径" class="headerlink" title="用 which 来查找命令的默认路径"></a>用 which 来查找命令的默认路径</h1><p>Linux 上有个 <code>which</code> 命令，它的作用是，在 PATH 变量指定的路径中，搜索某个系统命令的位置，并且返回第一个搜索结果。也就是说，使用 <code>which</code> 命令，就可以看到某个系统命令是否存在，以及执行的到底是哪一个位置的命令。</p> <p>下面的代码还原了 <code>which</code> 命令的用法：</p> <figure class="highlight powershell"><figcaption><span>which</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">which</span></span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$results</span> =<span class="built_in">New-Object</span> System.Collections.Generic.List[<span class="type">System.Object</span>];</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$command</span> <span class="keyword">in</span> <span class="variable">$args</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$path</span> = (<span class="built_in">Get-Command</span> <span class="variable">$command</span>).Source</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$path</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$results</span>.Add(<span class="variable">$path</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$results</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure> <p>用法：</p> <figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="built_in">which</span> bash notepad</span><br></pre></td></tr></table></figure> <p>输出：</p> <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">C:\Windows\System32\bash.exe</span><br><span class="line">C:\Windows\System32\notepad.exe</span><br></pre></td></tr></table></figure> <p>which 后面可以指定多个需要查找的命令。</p> <h1 id="用-killall-杀死指定名字的所有进程"><a href="#用-killall-杀死指定名字的所有进程" class="headerlink" title="用 killall 杀死指定名字的所有进程"></a>用 killall 杀死指定名字的所有进程</h1><figure class="highlight powershell"><figcaption><span>killall</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">killall</span></span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$commands</span> = <span class="built_in">Get-Process</span> <span class="variable">$args</span></span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$command</span> <span class="keyword">in</span> <span class="variable">$commands</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">Stop-Process</span> <span class="variable">$command</span>.Id</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure> <p>用法：</p> <figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">killall notepad cmd</span><br></pre></td></tr></table></figure> <p>killall 后面可以指定多个进程名。</p> </div> <blockquote class="post-copyright"> <div class="content"> <span class="post-time"> 最后更新时间：<time datetime="2020-01-01T06:28:00.000Z" itemprop="dateUpdated">2020年01月01日 14:28:00</time> </span><br> 本文共计 1,184 字，阅读时长预计 5 分钟<br>转载注明出处，原文地址：<a href="" target="_blank" rel="external">https://coolcode.org/2018/03/19/some-useful-scripts-of-powershell/</a> </div> <footer> <a href="https://coolcode.org"> <img src="../../../../img/avatar.jpg" alt="小马哥"> 小马哥 </a> </footer> </blockquote> <div class="page-reward"> <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-circle waves-light">赏</a> </div> <div class="post-footer"> <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="../../../../tags/powershell/">powershell</a></li></ul> <div class="page-share-wrap"> <div class="page-share" id="pageShare"> <ul class="reset share-icons"> <li> <a class="weibo share-sns" target="_blank" href="https://service.weibo.com/share/share.php?url=https://coolcode.org/2018/03/19/some-useful-scripts-of-powershell/&title=《几个有用的 PowerShell 脚本》 — CoolCode&pic=https://coolcode.org/img/avatar.jpg" data-title="微博"> <i class="icon icon-weibo"></i> </a> </li> <li> <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信"> <i class="icon icon-weixin"></i> </a> </li> <li> <a class="qq share-sns" target="_blank" href="https://connect.qq.com/widget/shareqq/index.html?url=https://coolcode.org/2018/03/19/some-useful-scripts-of-powershell/&title=《几个有用的 PowerShell 脚本》 — CoolCode&source=前一篇文章介绍了如何美化 PowerShell，今天来写几个比较实用的 PowerShell 脚本。" data-title=" QQ"> <i class="icon icon-qq"></i> </a> </li> <li> <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://coolcode.org/2018/03/19/some-useful-scripts-of-powershell/" data-title=" Facebook"> <i class="icon icon-facebook"></i> </a> </li> <li> <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《几个有用的 PowerShell 脚本》 — CoolCode&url=https://coolcode.org/2018/03/19/some-useful-scripts-of-powershell/&via=https://coolcode.org" data-title=" Twitter"> <i class="icon icon-twitter"></i> </a> </li> <li> <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://coolcode.org/2018/03/19/some-useful-scripts-of-powershell/" data-title=" Google+"> <i class="icon icon-google-plus"></i> </a> </li> </ul> </div> <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle"> <i class="icon icon-share-alt icon-lg"></i> </a> </div> </div> </div> <nav class="post-nav flex-row flex-justify-between"> <div class="waves-block waves-effect prev"> <a href="../../24/lolcat-in-powershell/" id="post-prev" class="post-nav-link"> <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div> <h4 class="title">lolcat in PowerShell</h4> </a> </div> <div class="waves-block waves-effect next"> <a href="../../16/how-to-make-your-powershell-beautiful/" id="post-next" class="post-nav-link"> <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div> <h4 class="title">PowerShell 美化指南</h4> </a> </div> </nav> <section class="comments" id="comments"> <div id="gitment_thread"></div> <script type="text/javascript" src="../../../../js/gitment.browser.min.js?v=1.7.2"></script> <script>var gitment=new Gitmint({lang:"zh-CN",owner:"andot",repo:"CoolCode",id:"几个有用的 PowerShell 脚本",oauth:{client_id:"0dfa8bd57a3253425991",client_secret:"cc7af9e85ee4abda607ea1a5d5a0f55e1e6c256a"}});gitment.render("comments")</script> </section> </article> <div id="reward" class="page-modal reward-lay"> <a class="close" href="javascript:;"><i class="icon icon-close"></i></a> <h3 class="reward-title"> <i class="icon icon-quote-left"></i> 感谢您的支持~ <i class="icon icon-quote-right"></i> </h3> <div class="reward-content"> <div class="reward-code"> <img id="rewardCode" src="../../../../img/wechat.jpg" alt="打赏二维码"> </div> <label class="reward-toggle"> <input id="rewardToggle" type="checkbox" class="reward-toggle-check" data-wechat="../../../../img/wechat.jpg" data-alipay="../../../../img/alipay.jpg"> <div class="reward-toggle-ctrol"> <span class="reward-toggle-item wechat">微信</span> <span class="reward-toggle-label"></span> <span class="reward-toggle-item alipay">支付宝</span> </div> </label> </div> </div> </div> <footer class="footer"> <div class="bottom"> <p> <span id="busuanzi_container_site_uv"> 站点总访客数：<span id="busuanzi_value_site_uv"><i class="icon icon-lg icon-spinner"></i></span> </span> <span id="busuanzi_container_site_pv"> 站点总访问量：<span id="busuanzi_value_site_pv"><i class="icon icon-lg icon-spinner"></i></span> </span> </p> <p> <span><a href="../../../../atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span> <span>博客内容遵循 <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">知识共享 署名 - 非商业性 - 相同方式共享 4.0 国际协议</a></span> </p> <p> <span>小马哥 &copy; 2005 - 2020</span> <span> <a href="http://www.miitbeian.gov.cn/" target="_blank">鲁ICP备17003119号-8</a> </span><span>Power by <a href="https://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a></span> <span>Hosted by <a href="https://pages.github.com" style="font-weight:700">GitHub Pages</a></span> </p> </div> </footer> </main> <div class="mask" id="mask"></div> <a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a> <div class="global-share" id="globalShare"> <ul class="reset share-icons"> <li> <a class="weibo share-sns" target="_blank" href="https://service.weibo.com/share/share.php?url=https://coolcode.org/2018/03/19/some-useful-scripts-of-powershell/&title=《几个有用的 PowerShell 脚本》 — CoolCode&pic=https://coolcode.org/img/avatar.jpg" data-title="微博"> <i class="icon icon-weibo"></i> </a> </li> <li> <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信"> <i class="icon icon-weixin"></i> </a> </li> <li> <a class="qq share-sns" target="_blank" href="https://connect.qq.com/widget/shareqq/index.html?url=https://coolcode.org/2018/03/19/some-useful-scripts-of-powershell/&title=《几个有用的 PowerShell 脚本》 — CoolCode&source=前一篇文章介绍了如何美化 PowerShell，今天来写几个比较实用的 PowerShell 脚本。" data-title=" QQ"> <i class="icon icon-qq"></i> </a> </li> <li> <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://coolcode.org/2018/03/19/some-useful-scripts-of-powershell/" data-title=" Facebook"> <i class="icon icon-facebook"></i> </a> </li> <li> <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《几个有用的 PowerShell 脚本》 — CoolCode&url=https://coolcode.org/2018/03/19/some-useful-scripts-of-powershell/&via=https://coolcode.org" data-title=" Twitter"> <i class="icon icon-twitter"></i> </a> </li> <li> <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://coolcode.org/2018/03/19/some-useful-scripts-of-powershell/" data-title=" Google+"> <i class="icon icon-google-plus"></i> </a> </li> </ul> </div> <div class="page-modal wx-share" id="wxShare"> <a class="close" href="javascript:;"><i class="icon icon-close"></i></a> <p>扫一扫，分享到微信</p> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAN4AAADeCAAAAAB3DOFrAAACuklEQVR42u3aQXLDIAwF0Nz/0u42M63xlwRNFo9Vx0kJjwXCkl6veFxvI3ny/vzu03y8z/A6MfDw8PAGS19PvV7070XkM6yfrGdbbyseHh7eOV4y3XpTeotIgk2yntvneHh4eF/DWx/3u6gJGw8PD+/7eetL8MMFN1hQFY+Hh4f3KV4vhZpjqundPIm8LdeCh4eHF/PyKtL3/H2kvoeHh4c3rqonxbC8VJYXvfIg9LBaPDw8vAO8/MCdNF3Nt2OyTjw8PLy9vGrxqZpKyAPApIR2OxseHh7ev/Dyl//10idBpRoYbv8LDw8P7zCvWrw/10bQC0WFdwU8PDy8Aa9X/q9uQdJclX+nXAzDw8PD28qrtjHlV/AeOE8HR1uMh4eHd4xXhVXbpHpb0NuUcq8BHh4e3lZe75hOkNVWg3I3BB4eHt4xXi8xMdmCXnFrVykODw8PbxcvObirada8rNVLHBcu6Hh4eHhbeXmV7IpHflnvHf1Ru0C1CIiHh4cX8/K0bA8z/7S3Njw8PLxzvMl1dlfqttdkEP0uHh4e3jFer/TVS8v2TuxegMHDw8M7weu9v0+aovJkxK758fDw8PbOn5SUJsmCeStAtQiHh4eHd5pXTdTmDVj5d8rxatJ0hYeHh7eJl3x1/fJfpU7as/IwhoeHh3eO1zvcq2mLSbtA4QK9K3bh4eHhtdK1VzB2LSXvDrvigYeHh/cpXrWUNQ8Y+RU8Ko/h4eHhbeVdxZGnAPK0Rd4ikFzBo54yPDw8vAGveuD2ylRJ4Oltay944OHh4c15k2DQmzMpcVXDyUNNDw8PD+8Ar1rWytMTm2NUvH48PDy8b+NVj+xeYKimdx+y1Hh4eHgf5eUhYXJN77Uy4OHh4f0Pr5cmmKcYeuWrQjkNDw8P7wCv98I/CRXVtGweYLblM/Dw8PD+XskPY96xhlL9wOoAAAAASUVORK5CYII=" alt="微信分享二维码"> </div> <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script> <script>var BLOG={ROOT:"/",SHARE:!0,REWARD:!0}</script> <script src="../../../../js/main.min.js?v=1.7.2"></script> <div class="search-panel" id="search-panel"> <ul class="search-result" id="search-result"></ul> </div> <template id="search-tpl"> <li class="item"> <a href="{path}" class="waves-block waves-effect"> <div class="title ellipsis" title="{title}">{title}</div> <div class="flex-row flex-middle"> <div class="tags ellipsis"> {tags} </div> <time class="flex-col time">{date}</time> </div> </a> </li> </template> <script src="../../../../js/search.min.js?v=1.7.2" async></script> <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script> </body> </html> 